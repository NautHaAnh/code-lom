<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>GSAP SplitText Scroll Test</title>

    <!-- GSAP CDN -->
    <script src="https://unpkg.com/gsap@3/dist/gsap.min.js"></script>
    <script src="https://unpkg.com/gsap@3/dist/ScrollTrigger.min.js"></script>
    <script src="https://unpkg.com/gsap@3/dist/SplitText.min.js"></script>

    <style>
        body {
            margin: 0;
            padding: 0;
            overflow-x: hidden;
            background-color: #161616;
        }

        .img {
            width: 100%;
            height: 100vh;
            background: url(img/1.jpg) no-repeat center center;
            background-size: cover;
        }

        .text {
            padding: 120px 0;
        }

        .text>h1>div {
            background: linear-gradient(to right,
                    rgb(255, 255, 255) 50%,
                    rgb(37, 37, 37) 50%);
            background-size: 200% 100%;
            background-position-x: 100%;
            color: transparent;
            background-clip: text;
            -webkit-background-clip: text;
            margin-left: 50px;
            line-height: 1.2;
            font-size: 50px;
        }
    </style>
</head>

<body>
    <div class="img"></div>

    <div class="text">
        <h1>
            Macaroon croissant pastry shortbread cupcake chupa chups pudding.
            Gummies pie candy canes sweet roll cake chupa chups cake fruitcake.
            Cake bonbon chupa chups carrot cake cake gingerbread cookie cake.
        </h1>
    </div>

    <div class="img"></div>

    <script>
        gsap.config({ trialWarn: false });
        console.clear();

        gsap.registerPlugin(ScrollTrigger, SplitText);

        let split;

        function makeItHappen() {
            split.lines.forEach((line) => {
                gsap.to(line, {
                    backgroundPositionX: "0%",
                    ease: "none",
                    scrollTrigger: {
                        trigger: line,
                        scrub: 0.5,
                        start: "top center",
                        end: "bottom center",
                        markers: true
                    }
                });
            });
        }

        function newTriggers() {
            ScrollTrigger.getAll().forEach(st => st.kill());

            if (split) split.revert();

            split = new SplitText("h1", { type: "lines" });

            makeItHappen();
            ScrollTrigger.refresh();
        }

        let resizeDelay = gsap.delayedCall(0.2, newTriggers).pause();
        window.addEventListener("resize", () => resizeDelay.restart(true));

        newTriggers();
    </script>
</body>

</html>